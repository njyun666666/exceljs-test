{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/hyperlink-xform.js"],"names":["BaseXform","require","HyperlinkXform","xmlStream","model","isInternalLink","leafNode","ref","address","rId","tooltip","location","target","node","name","attributes","test","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;IAEMC,c;;;;;;;;;;;;;SACJ,eAAU;AACR,aAAO,WAAP;AACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyB;AACvB,UAAI,KAAKC,cAAL,CAAoBD,KAApB,CAAJ,EAAgC;AAC9BD,QAAAA,SAAS,CAACG,QAAV,CAAmB,WAAnB,EAAgC;AAC9BC,UAAAA,GAAG,EAAEH,KAAK,CAACI,OADmB;AAE9B,kBAAQJ,KAAK,CAACK,GAFgB;AAG9BC,UAAAA,OAAO,EAAEN,KAAK,CAACM,OAHe;AAI9BC,UAAAA,QAAQ,EAAEP,KAAK,CAACQ;AAJc,SAAhC;AAMD,OAPD,MAOO;AACLT,QAAAA,SAAS,CAACG,QAAV,CAAmB,WAAnB,EAAgC;AAC9BC,UAAAA,GAAG,EAAEH,KAAK,CAACI,OADmB;AAE9B,kBAAQJ,KAAK,CAACK,GAFgB;AAG9BC,UAAAA,OAAO,EAAEN,KAAK,CAACM;AAHe,SAAhC;AAKD;AACF;;;WAED,mBAAUG,IAAV,EAAgB;AACd,UAAIA,IAAI,CAACC,IAAL,KAAc,WAAlB,EAA+B;AAC7B,aAAKV,KAAL,GAAa;AACXI,UAAAA,OAAO,EAAEK,IAAI,CAACE,UAAL,CAAgBR,GADd;AAEXE,UAAAA,GAAG,EAAEI,IAAI,CAACE,UAAL,CAAgB,MAAhB,CAFM;AAGXL,UAAAA,OAAO,EAAEG,IAAI,CAACE,UAAL,CAAgBL;AAHd,SAAb,CAD6B,CAO7B;;AACA,YAAIG,IAAI,CAACE,UAAL,CAAgBJ,QAApB,EAA8B;AAC5B,eAAKP,KAAL,CAAWQ,MAAX,GAAoBC,IAAI,CAACE,UAAL,CAAgBJ,QAApC;AACD;;AACD,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD;;;WAED,qBAAY,CAAE;;;WAEd,sBAAa;AACX,aAAO,KAAP;AACD;;;WAED,wBAAeP,KAAf,EAAsB;AACpB;AACA,aAAOA,KAAK,CAACQ,MAAN,IAAgB,yBAAyBI,IAAzB,CAA8BZ,KAAK,CAACQ,MAApC,CAAvB;AACD;;;;EAhD0BZ,S;;AAmD7BiB,MAAM,CAACC,OAAP,GAAiBhB,cAAjB","sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nclass HyperlinkXform extends BaseXform {\r\n  get tag() {\r\n    return 'hyperlink';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (this.isInternalLink(model)) {\r\n      xmlStream.leafNode('hyperlink', {\r\n        ref: model.address,\r\n        'r:id': model.rId,\r\n        tooltip: model.tooltip,\r\n        location: model.target,\r\n      });\r\n    } else {\r\n      xmlStream.leafNode('hyperlink', {\r\n        ref: model.address,\r\n        'r:id': model.rId,\r\n        tooltip: model.tooltip,\r\n      });\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (node.name === 'hyperlink') {\r\n      this.model = {\r\n        address: node.attributes.ref,\r\n        rId: node.attributes['r:id'],\r\n        tooltip: node.attributes.tooltip,\r\n      };\r\n\r\n      // This is an internal link\r\n      if (node.attributes.location) {\r\n        this.model.target = node.attributes.location;\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n\r\n  isInternalLink(model) {\r\n    // @example: Sheet2!D3, return true\r\n    return model.target && /^[^!]+![a-zA-Z]+[\\d]+$/.test(model.target);\r\n  }\r\n}\r\n\r\nmodule.exports = HyperlinkXform;\r\n"],"file":"hyperlink-xform.js"}