{"version":3,"sources":["../../../lib/utils/copy-style.js"],"names":["oneDepthCopy","obj","nestKeys","reduce","memo","key","setIfExists","src","dst","isEmptyObj","Object","keys","length","copyStyle","style","copied","border","fill","stops","map","s","exports"],"mappings":"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","sourcesContent":["const oneDepthCopy = (obj, nestKeys) => ({\r\n  ...obj,\r\n  ...nestKeys.reduce((memo, key) => {\r\n    if (obj[key]) memo[key] = {...obj[key]};\r\n    return memo;\r\n  }, {}),\r\n});\r\n\r\nconst setIfExists = (src, dst, key, nestKeys = []) => {\r\n  if (src[key]) dst[key] = oneDepthCopy(src[key], nestKeys);\r\n};\r\n\r\nconst isEmptyObj = obj => Object.keys(obj).length === 0;\r\n\r\nconst copyStyle = style => {\r\n  if (!style) return style;\r\n  if (isEmptyObj(style)) return {};\r\n\r\n  const copied = {...style};\r\n\r\n  setIfExists(style, copied, 'font', ['color']);\r\n  setIfExists(style, copied, 'alignment');\r\n  setIfExists(style, copied, 'protection');\r\n  if (style.border) {\r\n    setIfExists(style, copied, 'border');\r\n    setIfExists(style.border, copied.border, 'top', ['color']);\r\n    setIfExists(style.border, copied.border, 'left', ['color']);\r\n    setIfExists(style.border, copied.border, 'bottom', ['color']);\r\n    setIfExists(style.border, copied.border, 'right', ['color']);\r\n    setIfExists(style.border, copied.border, 'diagonal', ['color']);\r\n  }\r\n\r\n  if (style.fill) {\r\n    setIfExists(style, copied, 'fill', ['fgColor', 'bgColor', 'center']);\r\n    if (style.fill.stops) {\r\n      copied.fill.stops = style.fill.stops.map(s => oneDepthCopy(s, ['color']));\r\n    }\r\n  }\r\n\r\n  return copied;\r\n};\r\n\r\nexports.copyStyle = copyStyle;\r\n"],"file":"copy-style.js"}